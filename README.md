# 💬 LLM 기반 턴제 게임: 인생 상담소

---
### 게임 개요
'인생 상담소'의 상담사가 되어, 총 5턴 동안 4명의 내담자를 상담하는 텍스트 기반 시뮬레이션 게임입니다.<br>
매 턴마다 한 명의 내담자를 선택하고, 그들의 고민에 대한 조언을 직접 입력합니다. <br>
LLM(내담자)은 플레이어의 조언을 바탕으로 감정적인 반응을 보이고, 조언의 적절성에 따라 '만족도' 점수가 변합니다.<br>

---
### 게임의 진행 순서
1. 게임이 시작되면 플레이어(상담사)에게 4명의 내담자가 배정됩니다.<br>
2. 플레이어는 4명 중 1명을 선택해 상담을 시작합니다.<br>
3. 내담자의 현재 고민을 확인하고, 플레이어가 조언(상담 내용)을 텍스트로 입력합니다.<br>
4. 상담을 마친 후, 턴이 1 증가합니다.<br>

---
### 엔딩 조건
게임은 다음 두 가지 조건 중 하나가 충족되면 종료됩니다.<br>
- 상담 완료 (만족): 특정 내담자의 '만족도'가 10점 이상이 되면, 해당 내담자는 만족하며 상담소를 떠납니다.<br>
  이 경우, '상담 완료' 목록에 추가되고 대기열에서 사라집니다.<br>
  아직 5턴이 끝나지 않았다면, 즉시 새로운 내담자가 대기열에 추가됩니다.<br>
  
- 턴 종료: 총 5턴이 모두 소요되면 게임이 즉시 종료됩니다.<br>
  최종적으로 '상담 완료'에 성공한 내담자 목록과, 5턴이 끝날 때까지 '미완료' 상태로 남은 내담자 목록이 결과로 표시됩니다.<br>

---
### 점수 시스템
플레이어가 조언을 제출하면, 내담자(LLM)는 그 조언을 바탕으로 -5점에서 +5점 사이의 점수를 내부적으로 평가합니다.<br>
이 점수는 해당 내담자의 만족도에 누적됩니다.<br>
만족도가 높을수록 내담자는 더 깊은 고민을 털어놓거나 긍정적인 반응을 보입니다.<br>

---
### 트러블슈팅 (개발 여정)
인생 상담소로 바꾸게 되었다. <br>
기존의 '인생의 선택'이라는 게임은 주인공에게 요구 사항을 전달하여 그 요구사항을 턴별로 하나씩 들어주는 게임이었다. <br>
하지만 이 게임은 주인공과 특정한 관계에 있는 사람들과 대화하는 구조의 게임으로서, 모델이 관계를 잘 해석해야 하나 이를 잘 하지 못하고 역할을 혼동하는 경우가 많았다. <br>
예를 들어 주인공이 범수, 아내가 다인이라면 다인이 어느샌가부터 범수인 듯 다인 자신에게 대답하는 것처럼 내용을 적는 경우가 생겼다. <br>
그리고 주인공의 응답에 대한 답변으로 메세지 히스토리의 요약된 형태를 제출하는(예: Human: 나는 당신과 여행을 가고 싶어요) 경우도 있었다. <br>
또한 자기 자신이라는 관계는 모델이 거의 해석하지 못하는 수준으로 요구사항을 만드는 경우가 많았다. <br>
그리고 모델이 처리해야할 또 하나의 부담으로, 턴제에서 선택받지 못하는 경우에 대한 처리도 있었다.<br>
선택받지 못했을 때도 이에 대한 내용을 전달하며 상대방의 부정적 반응을 생성하여 사용하려 했다. <br>
앞서 서술한 히스토리 제출 문제 같은 것도 그것을 처리하는 과정이 어렵기 때문에 생긴 것 같다. <br> 
그래서 관계와 턴구조를 조금 더 가볍게 만들기 위해 그러한 정보를 덜 담을 수 있는 상담으로 전향하게 되었다.<br>

기본적인 코드의 구조는 비슷하다.<br>
턴제로 진행되고 객체를 class 인스턴스로 생성하여 메세지를 저장하는 구조로 두었다. <br>
다만 미선택된 자들은 턴의 진행에서 일시 정지되는 구조로, 그리고 상담자와 내담자는 특정 관계를 갖지 않게 만들었다. <br>
결과적으로는 요구사항을 생성하는 것보다 상담 질문을 생성하는 능력이 훨씬 괜찮다는 결론을 얻게 되었다.

---
### 기술 스택
Python<br>
Streamlit (Web UI)<br>
Ollama (로컬 LLM 구동)<br>
EEVE-Korean-10.8B (GGUF)<br>

---
### 개발자 노트

##### 생각 정리
- 게임에 LLM을 접목시킴으로써 얻을 수 있는 이점은 무엇일까.
1. 트랜스포머를 활용한 기능 : 기계번역, 감정분석, 텍스트생성, NER, QnA, Fill-Mask, 요약, 특징 추출(사용처가 이후 요약이나 감정분석 혹은 유사도일 듯), 제로샷분류
2. LLM의 강점을 맥락 파악과 그럴싸한 이야기의 연결이라고 보았을 때, 구체적으로 정해지지 않은 입력을 통해 다양한 결과를 도출할 수 있는 게임이 좋을 것 같음. 하지만 이는 사실 텍스트 생성이라는 테스크로 한정시켜서 본 것일 수도 있다.
3. 굳이 LLM 기능활용에 매몰되기보다 더 재밌는 게임에 대한 생각이 생기면 바꿔도 좋을 듯하다.
- 게임에 있어 중요한 것은 무엇일까.
1. 재미, 이 게임이 재미가 있을까. 이건 고민해 봐야할 숙제, 서브 이벤트(게임 안의 게임 같은 거)를 도입하는 것도 고민해 봐야할 듯하다다.
2. 게임에도 다큐 영화와 같은 장르가 있으면 안 될까.
- 다른 아이디어 생각해 본 것들.
1. 코딩 방탈출
2. 베스킨 라빈스 31, 여러 명이 구성되는데 이때 똑똑이(생존 확률을 높이는 선택을 하는 애)와 안똑똑이(랜덤 선택을 하는 애)로 구성
3. 영화 주연(혹은 조연)의 페르소나(외적 인격)를 가진 익명의 캐릭터와 대화를 하며 영화 제목 맞히기
4. 영화속 등장인물을 선택하고 그 사람과 연애 시뮬레이션해서 점수 얻기
5. 영화 조연의 시점으로 쓴 일기를 읽고 영화 제목 맞히기, 이건 재미 없을 듯.
6. 인생의 선택 : 인생의 선택들에 대해 누적된 결과를 보여주는 게임, 기존에 선택했으나 구현상의 문제로 인생 상담소로 바꾸게 되었다. 

---
### 회고
- 솔직히 모델의 성능이 원하는 만큼 따라주지 않아 흥미가 떨어지는 경우가 많았다. 혼자 프로젝트를 진행하며 무언가를 끝까지 완주하기 위해선 흥미보단 의지가 중요한 것 같다.
